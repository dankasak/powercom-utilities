create or replace view vw_off_peak as
select
    id
  , reading_datetime
  , reading_type
  , case
        when ( reading_datetime::TIME between '22:00:00' and '23:59:59'
            or reading_datetime::TIME between '00:00:00' and '06:59:59'
        ) then watts
          else 0
    end as watts
from
    public.powercom_readings
where
    reading_type = 'Consumption'